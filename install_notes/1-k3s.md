Installing K3s

```
#k8s box
curl -sfL https://get.k3s.io | sh -s - 

#kubectl on k8s box
sudo cp /etc/rancher/k3s/k3s.yaml ~/k3s-config
sudo chown $USER:$USER ~/k3s-config

# client box 
scp <user>>@<192.168.1.X>:~/k3s-config ./config

code ./config

#modify / update the ip to the server ip 
# move it to your kube config folder location > connect 
```

set dns on k8s box

```
sudo nano /etc/resolv.conf
```

update dns

apply the trafik yaml 
```
helm repo add traefik https://traefik.github.io/charts && helm repo update

helm upgrade traefik traefik/traefik -n kube-system -f /Users/peterknowles/Repo/argo-home/bootstrap/trafik-values.yaml

```

jetstacks / cert-manager 
```
helm repo add jetstack https://charts.jetstack.io
helm repo update


helm install cert-manager jetstack/cert-manager \
  --namespace cert-manager \
  --create-namespace \
  --set crds.enabled=true

```

You will need an. external domain here we will go with instructions if that is managed by cloudflare

Create an API Token in Cloudflare:

    Go to My Profile > API Tokens > Create Token.

    Use the template Edit zone DNS.

    Select your specific zone (home.co.uk).

    Copy the token (you will see it only once).

Create the A Record:

    In Cloudflare DNS settings, create an A Record.

    Name: argo (e.g., for argo.home.co.uk)

    Content: 192.168.x.x (Put your Internal K3s Node IP here).

    Proxy Status: DNS Only (Grey Cloud). Important: Do not use the Orange Cloud (Proxy) for private IPs.

```
kubectl create secret generic cloudflare-api-token-secret \
  --namespace cert-manager \
  --from-literal=api-token=YOUR_CLOUDFLARE_API_TOKEN
```

Modify 

```
bootstrap/example-cloudflare-issuer.yaml
```

then deploy it 

```
kubectl apply -f cloudflare-issuer.yaml
```